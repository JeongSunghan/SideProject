<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Wordle</title>
    <link rel="stylesheet" href="wordle.css" />
  </head>
  <body>
    <!-- 게임 입력 필드 -->
    <div id="inputContainer">
      <input class="input" maxlength="1" />
      <input class="input" maxlength="1" />
      <input class="input" maxlength="1" />
      <input class="input" maxlength="1" />
      <input class="input" maxlength="1" />
    </div>

    <button id="submitBtn">제출</button>

    <!-- 이전 시도한 답들을 표시할 영역 -->
    <div id="previousAttemptsContainer">
      <h3>이전 시도:</h3>
    </div>

    <script>
      //정답 횟수 지정 하기
      let answer = ""; 
      let attempts = 0; 
      const maxAttempts = 5; 

      // 랜덤 워드 API를 통해 랜덤 5글자 단어를 가져오기
      fetch("https://random-word-api.herokuapp.com/word?number=1&length=5")
        .then((response) => response.json())
        .then((data) => {
          answer = data[0].toLowerCase(); 
          console.log("Today's Word: " + answer); // 콘솔에 정답 출력 (디버깅용!! 나중에 주석 처리하기)
        })
        .catch((error) => {
          console.error("Error fetching the word:", error);
          alert("단어를 불러오는 데 실패했습니다. 다시 시도해주세요.");
        });

      // 제출 버튼 클릭 시 실행
      document.querySelector("#submitBtn").addEventListener("click", function () {
        if (attempts >= maxAttempts) {
          alert("더 이상 시도할 수 없습니다!");
          return;
        }

        const inputs = document.querySelectorAll(".input");
        let userGuess = "";

        // 사용자 입력 값을 저장
        for (let i = 0; i < inputs.length; i++) {
          userGuess += inputs[i].value.toLowerCase();
        }

        const previousAttempt = document.createElement('div');
        previousAttempt.classList.add('attempt-row');

        for (let i = 0; i < answer.length; i++) {
          // 시각적 피드백(UX)을 위한 새로운 입력 필드 생성
          const resultBox = document.createElement('input');
          resultBox.disabled = true;  // 입력 불가

          // 위치가 맞으면 초록색
          if (inputs[i].value.toLowerCase() === answer[i]) {
            resultBox.style.background = "green";
          } 
          // 위치가 틀리지만 문자가 존재하면 노란색
          else if (answer.includes(inputs[i].value.toLowerCase())) {
            resultBox.style.background = "yellow";
          } 
          // 둘 다 아니면 회색
          else {
            resultBox.style.background = "lightgrey";
          }

          // 이전 시도값을 기록
          resultBox.value = inputs[i].value.toLowerCase();
          resultBox.classList.add("input");
          previousAttempt.appendChild(resultBox);
        }

        // 이전 시도 기록을 추가
        document.querySelector("#previousAttemptsContainer").appendChild(previousAttempt);

        attempts++;  // 시도 횟수 증가

        // 새로운 입력을 위해 기존 필드 초기화
        if (attempts < maxAttempts) {
          for (let i = 0; i < inputs.length; i++) {
            inputs[i].value = "";  // 필드 초기화
            inputs[i].style.background = "";  // 배경색 초기화
          }
        } else {
          alert("게임 종료! 정답은: " + answer);
        }
      });
    </script>
  </body>
</html>
